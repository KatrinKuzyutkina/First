@startuml
actor Пользователь
participant Игра
participant Корабль
participant СостояниеИгры
participant Компьютер
participant Бомба

Пользователь -> Игра: Запускает игру

alt Выбор расстановки кораблей
    Пользователь -> Игра: Расстановка вручную
    Игра -> СостояниеИгры: Обновить расстановку
else Автоматическая расстановка
    Игра -> СостояниеИгры: Автоматически расставить корабли
end

Игра -> Компьютер: Расставить корабли

Игра -> Пользователь: Начать бой

loop Игровой цикл
    Пользователь -> Игра: Стреляет по координате
    Игра -> Корабль: Проверить попадание
    alt Попадание
        Корабль -> СостояниеИгры: Состояние обновлено
        Корабль -> Пользователь: "Дополнительный ход"
        СостояниеИгры -> Игра: Дополнительный ход
        alt Бомба
            Игра -> Пользователь: Дополнительный ход, Бомба активирована
            Пользователь -> Бомба: Выбор координаты для бомбы
            Бомба -> СостояниеИгры: Атаковать область 3x3
            Игра -> Пользователь: Обновить игровое поле
        end
    else Мимо
        Игра -> Компьютер: Ход переходит компьютеру
    end
    
    Игра -> Пользователь: Обновить игровое поле
    Пользователь -> Игра: Завершить ход

    Компьютер -> Игра: Стреляет по координате
    Игра -> Корабль: Проверить попадание
    alt Попадание
        Корабль -> СостояниеИгры: Состояние обновлено
        Корабль -> Компьютер: "Дополнительный ход"
    else Мимо
        Компьютер -> Игра: Ход переходит игроку
    end

    Игра -> Пользователь: Обновить игровое поле
    
    alt Игра завершена (все корабли потоплены у одного из игроков)
        Игра -> Пользователь: "Вы выиграли!" или "Вы проиграли"
        Игра -> Пользователь: Игра завершена
    end
end
@enduml
